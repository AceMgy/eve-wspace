<div clas="sysLSdiv">
    <span class="sysLastScanned label {% if scanwarning  %} label-warning {% endif %}">
        {% load humanize %}
    Last Scanned: {{system.system.lastscanned|date:"Y-m-d H:i"}} ({{system.system.lastscanned|naturaltime}})
    </span> &nbsp 
    <i id="markScanned" onclick="MarkScanned({{system.pk}}, true, {{system.system.pk}});" class="icon-refresh" title="Mark Scanned"></i>
    <br />
</div>
<table class="sysSigsTable">
    <tr>
    <th>Actions</th>
    <th>Upd.</th>
    <th>Sig ID</th>
    <th>Type</th>
    <th>Info</th>
    <th>Act. / Rats</th>
    <th>Escl.</th>
    </tr>
    {% for sig in system.system.signatures.all %}
    <tr>
        <td><i class="icon-pencil" title="Edit" onclick="GetEditSignatureBox({{system.pk}}, {{sig.pk}}, {{system.pk}});"></i> &nbsp
            <i class="icon-ban-circle" title="Delete" onclick="DeleteSignature({{sig.pk}}, {{system.pk}});"></i> </td>
        <td>
            {% if sig.updated %}
                <i class="icon-ok-sign" title="Signature Updated"></i> &nbsp
            {% else %}
                <i class="icon-remove-sign" title="Signature Not Updated"></i> &nbsp
            {% endif %}
            </td>
            <td><span class="signatureID">{{sig.sigid}}</span> </td>
            <td><span class="signatureType" onclick="GetSiteSpawns({{system.pk}}, {{sig.pk}});" title="{{sig.sigtype.longname}}">{{sig.sigtype.shortname}}</span></td>
            <td><span class="signatureInfo">{{sig.info}}</span></td>
            <td>
            {% if sig.activated %}
            {% if not sig.ratscleared %}
            <i id="icn{{sig.pk}}Activated" class="icon-warning-sign" title="Activated at {{sig.activated|date:'Y-m-d H:i'}} {% if sig.sigtype.sleeprsite %}but NPCs not cleared!{% endif %} Ctrl+Click to deactivate."></i> 
            <script type="text/javascript">
                $('#icn{{sig.pk}}Activated').click(function(e){
                            if (e.ctrlKey){
                                MarkActivated({{sig.pk}}, {{system.pk}});
                                }
                                {% if sig.sigtype.sleeprsite %}
                                else{
                                MarkCleared({{sig.pk}}, {{system.pk}});
                                } 
                                {% endif %}
                        });
            </script>
            {% elif sig.sigtype.sleeprsite %}
            <i class="icon-screenshot" onclick="MarkCleared({{sig.pk}}, {{system.pk}});" title="NPCs cleared at {{sig.ratscleared|date:'Y-m-d H:i'}}"></i> 
            {% endif %}
            {% else %}
            <i class="icon-off" onclick="MarkActivated({{sig.pk}}, {{system.pk}});" title="Not activated."></i>
            {% endif %}
            </td>
            <td>
            {% if sig.sigtype.escalatable and sig.system.sysclass > 4 and sig.system.sysclass < 7 %}
                {% if not sig.lastescalated %}
                    {% if sig.downtimes > 2 %}
                    <i class="icon-fire" onlick="MarkEscalated({{sig.pk}}, {{system.pk}});" title="Site will despawn at DT."></i>
                    {% else %}
                    <i class="icon-fullscreen" onclick="MarkEscalated({{sig.pk}}, {{system.pk}});" title="Clear escalation only."></i>
                    {% endif %}        
                {% else %}    
                <i class="icon-ok" onclick="MarkEscalated({{sig.pk}}, {{system.pk}});" title="Site escalated today."></i>
                {% endif %}    
                {% endif %}
            </td>
        {% empty %}
        <tr><td>No Signatures!</td></tr>
    </tr>
            {% endfor%}
</table>
